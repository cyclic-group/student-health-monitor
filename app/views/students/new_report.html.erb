<%= render 'layouts/nav_student' %>
<%= render 'layouts/flash' %>

<div class="container-md">
    <div class="row justify-content-center">
        <div class="col-12 title col-12 text-center mt-4 mb-4">健康打卡</div>
        <div class="col-10">
        <%= form_with model: @report, scope: :report, method: 'post', url: student_report_path, class: 'needs-validation', html: { novalidate: true } do |form| %>
        <div class='input-group row mb-3'>
            <%= form.label :step_count, '步数', class: 'form-label outer-label col-6' %>
            <button class="btn btn-outline-secondary col-auto decrement-button" type="button"><i class="fa-solid fa-minus"></i></button>
            <%= form.number_field :step_count, class: 'form-control col-auto text-center', value: '0', required: true, min: '0' %>
            <button class="btn btn-outline-secondary col-auto increment-button" type="button"><i class="fa-solid fa-plus"></i></button>
            <div class="invalid-feedback">
                请填写有效数字
            </div>
        </div>
        <div class="input-group row mb-3">
            <%= form.label :sleep_hours, '睡眠小时', class: 'form-label outer-label col-6' %>
            <button class="btn btn-outline-secondary col-auto decrement-button" type="button"><i class="fa-solid fa-minus"></i></button>
            <%= form.number_field :sleep_hours, class: 'form-control col-auto text-center', value: '0', required: true, min: '0', max: '24' %>
            <button class="btn btn-outline-secondary col-auto increment-button" type="button"><i class="fa-solid fa-plus"></i></button>
            <div class="invalid-feedback">
                请填写有效数字
            </div>
        </div>
            <%= form.label :symptons, '是否具有以下症状：', class: 'form-label outer-label mb-3'%>
            <%= form.collection_check_boxes :symptons, ['发热', '呕吐', '腹泻', '咳嗽', '咽痛', '鼻塞', '流涕'], :to_s, :to_s do |b| %>
                <div class="form-check ms-3">
                    <%= b.check_box class: "form-check-input checkbox" %>
                    <%= b.label class: "form-check-label" %>
                </div>
            <% end %>
            <%= form.submit '提交', class: "button-submit mt-4 d-block mx-auto" %>
        <% end %>
        </div>
    </div>
</div>

<script>
(function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.needs-validation')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })
})()

document.querySelectorAll('.increment-button').forEach( button =>
    button.addEventListener('click', () => button.previousElementSibling.stepUp() )
);

document.querySelectorAll('.decrement-button').forEach( button =>
    button.addEventListener('click', () => button.nextElementSibling.stepDown() )
);

</script>